exports.id=6454,exports.ids=[6454],exports.modules={80326:e=>{e.exports={button_danger:"productForm_button_danger__HuxDf"}},96454:(e,a,l)=>{"use strict";l.a(e,async(e,s)=>{try{l.r(a),l.d(a,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var t=l(20997),r=l(95566),c=l.n(r),i=l(16689),d=l(42820),n=l(3590),o=l(15941),m=l(2022),u=l(94504),p=l(49460),h=l(76606),x=l(18214),b=l(80326),j=l.n(b),g=l(58165),N=l(57987),f=e([n,o,u,N]);[n,o,u,N]=f.then?(await f)():f;let __WEBPACK_DEFAULT_EXPORT__=e=>{let a=`/api/product/edit?slug=${e.slug}`,{data:l,error:s}=(0,o.default)(a,m.gN),r=(0,i.useRef)(),b=(0,i.useRef)(""),f=(0,i.useRef)(""),[v,y]=(0,i.useState)([]),[S,w]=(0,i.useState)([]),[C,F]=(0,i.useState)([]),[I,_]=(0,i.useState)([]),[k,V]=(0,i.useState)(""),[q,P]=(0,i.useState)(""),[E,D]=(0,i.useState)(""),[T,W]=(0,i.useState)([]),[O,A]=(0,i.useState)([]),[J,B]=(0,i.useState)(""),[M,U]=(0,i.useState)([]),[R,$]=(0,i.useState)([]),[z,H]=(0,i.useState)([]),[K,L]=(0,i.useState)([]),[Q,X]=(0,i.useState)(""),[G,Z]=(0,i.useState)(""),{t:Y}=(0,N.useTranslation)();if((0,i.useEffect)(()=>{if(l&&l.product){let e=[];l.product.colors.forEach(a=>e.push({label:a.label,value:a.value}));let a=[];if(l.product.attributes.forEach(e=>a.push({label:e.label,value:e.value,for:e.for})),y(e),w(l.product.attributeIndex?l.product.attributeIndex:""),F(a),_(l.product.type),U(l.product.variants),$(l.product.image),H(l.product.gallery),L(l.product.seo.image),X(l.product.description),l.product.categories[0]){V(l.product.categories[0]),P(l.product.subcategories[0]),D(l.product.childCategories[0]);let e=l.category.find(e=>e.slug===l.product.categories[0]),a=[],s=[];e.subCategories.forEach(e=>{a.push({name:e.name,slug:e.slug}),e.child?.forEach(e=>{s.push({name:e.name,slug:e.slug})})}),W(a),A(s)}}},[l]),(0,i.useEffect)(()=>{let e=(v.length||1)*(C.length||1);if(M.length!==e){let e=[];v.length&&C.length?v.map(a=>{C.map(l=>{let s={color:a.label,attr:l.label,price:"",sku:"",qty:"",imageIndex:0};e.push(s)})}):v.length&&!C.length?v.map(a=>{let l={color:a.label,attr:null,price:"",sku:"",qty:"",imageIndex:0};e.push(l)}):!v.length&&C.length&&C.map(a=>{let l={color:null,attr:a.label,price:"",sku:"",qty:"",imageIndex:0};e.push(l)}),U(e)}},[v,C,M.length]),s)return t.jsx("div",{children:"failed to load"});if(!l)return t.jsx(x.default,{});if(!l.product)return t.jsx(c(),{statusCode:404});let ee=[];l.color&&l.color.map(e=>ee.push({label:e.name,value:e.value}));let ea=l.product.attributeIndex?l.product.attributeIndex:"",changeAttr=e=>{w(e),F([])},handleInputChange=(e,a)=>{let{name:l,value:s}=e.target,t=[...M];t[a][l]=s,U(t)},getEditorStateData=e=>{let a=e.replace(/(<([^>]+)>)/gi,"").length?e:"";return a},formHandler=async e=>{e.preventDefault(),Z("loading");let a=document.querySelector("#product_form"),l=new FormData(a),s=JSON.stringify(R),t=JSON.stringify(z),r={title:b.current.value.trim(),description:f.current.value.trim(),image:K};l.append("displayImage",s),l.append("galleryImages",t),l.append("type",I),l.append("category",JSON.stringify([k])),l.append("subcategory",JSON.stringify([q])),l.append("childCategory",JSON.stringify([E])),l.append("brand",J),l.append("color",JSON.stringify(v)),l.append("attribute",JSON.stringify(C)),l.append("selectedAttribute",S),l.append("variant",JSON.stringify(M)),l.append("seo",JSON.stringify(r)),l.append("description",getEditorStateData(Q)),await (0,m.qC)("/api/product/edit",l).then(e=>e.success?n.toast.success("Product Updated Successfully"):n.toast.error("Something Went Wrong")).catch(e=>{console.log(e),n.toast.error(`Something Went Wrong ${e.message}`)}),Z("")};return(0,t.jsxs)("form",{id:"product_form",encType:"multipart/form-data",onSubmit:formHandler,children:[(0,t.jsxs)("div",{className:"row",children:[(0,t.jsxs)("div",{className:"col-lg-8",children:[(0,t.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[t.jsx("div",{className:"card-header bg-white py-3 fw-bold",children:Y("Product Type")}),(0,t.jsxs)("div",{className:"card-body",children:[(0,t.jsxs)("div",{className:"row",children:[t.jsx("div",{className:"col-md-4",children:(0,t.jsxs)("div",{className:"py-3",children:[t.jsx("label",{htmlFor:"inp-110",className:"form-label",children:Y("new_product")}),(0,t.jsxs)("div",{className:"form-check form-switch",children:[t.jsx("input",{className:"form-check-input",type:"checkbox",id:"inp-110",name:"new_product",defaultChecked:l.product.new}),t.jsx("label",{className:"form-check-label",htmlFor:"inp-110",children:Y("status")})]})]})}),t.jsx("div",{className:"col-md-4",children:(0,t.jsxs)("div",{className:"py-3",children:[t.jsx("label",{htmlFor:"inp-11",className:"form-label",children:Y("trending_product")}),(0,t.jsxs)("div",{className:"form-check form-switch",children:[t.jsx("input",{className:"form-check-input",type:"checkbox",id:"inp-11",name:"trending",defaultChecked:l.product.trending}),t.jsx("label",{className:"form-check-label",htmlFor:"inp-11",children:Y("status")})]})]})}),t.jsx("div",{className:"col-md-4",children:(0,t.jsxs)("div",{className:"py-3",children:[t.jsx("label",{htmlFor:"inp-111",className:"form-label",children:Y("best_selling_product")}),(0,t.jsxs)("div",{className:"form-check form-switch",children:[t.jsx("input",{className:"form-check-input",type:"checkbox",id:"inp-111",name:"best_selling",defaultChecked:l.product.bestSelling}),t.jsx("label",{className:"form-check-label",htmlFor:"inp-111",children:Y("status")})]})]})})]}),t.jsx("div",{className:"col-12",children:(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{htmlFor:"inp-type",className:"form-label",children:[Y("Product Type"),"*"]}),(0,t.jsxs)("select",{id:"inp-type",ref:r,className:j().input+" form-control",required:!0,onChange:()=>_(r.current.value),defaultValue:l.product.type,children:[t.jsx("option",{value:"",disabled:!0,children:Y("Select Product Type")}),t.jsx("option",{value:"simple",children:"Simple Product"}),t.jsx("option",{value:"variable",children:"Variable Product"})]})]})})]})]}),(0,t.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[t.jsx("div",{className:"card-header bg-white py-3 fw-bold",children:Y("Product Image")}),(0,t.jsxs)("div",{className:"card-body",children:[t.jsx(u.default,{accept:".jpg,.png,.jpeg",label:Y("Display Image"),maxFileSizeInBytes:2e6,updateFilesCb:e=>$(e),preSelectedFiles:l.product.image}),t.jsx(u.default,{accept:".jpg,.png,.jpeg",label:Y("Gallery Images"),multiple:!0,maxFileSizeInBytes:2e6,updateFilesCb:e=>H(e),preSelectedFiles:l.product.gallery})]})]}),(0,t.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[t.jsx("div",{className:"card-header bg-white py-3 fw-bold text-center",children:Y("Product Description")}),(0,t.jsxs)("div",{className:"card-body",children:[(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{htmlFor:"inp-1",className:"form-label",children:[Y("name"),"*"]}),t.jsx("input",{type:"text",id:"inp-1",className:j().input+" form-control",name:"name",defaultValue:l.product.name,required:!0})]}),(0,t.jsxs)("div",{className:"row",children:[t.jsx("div",{className:"col-12 col-sm-6",children:(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{htmlFor:"inp-2",className:"form-label",children:[Y("Unit"),"*"]}),t.jsx("input",{type:"text",id:"inp-2",className:j().input+" form-control",name:"unit",defaultValue:l.product.unit,required:!0})]})}),t.jsx("div",{className:"col-12 col-sm-6",children:(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{htmlFor:"inp-3",className:"form-label",children:[Y("Unit Value"),"*"]}),t.jsx("input",{type:"text",id:"inp-3",className:j().input+" form-control",name:"unit_val",defaultValue:l.product.unitValue,required:!0})]})})]})]})]}),(0,t.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[t.jsx("div",{className:"card-header bg-white py-3 fw-bold",children:Y("Product Description")}),(0,t.jsxs)("div",{className:"card-body",children:[(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{htmlFor:"inp-7",className:"form-label",children:[Y("Short Description"),"*"]}),t.jsx("textarea",{id:"inp-7",className:j().input+" form-control",name:"short_description",defaultValue:l.product.shortDescription})]}),(0,t.jsxs)("div",{className:"py-3",children:[t.jsx("label",{className:"form-label",children:Y("description")}),t.jsx(p.default,{previousValue:Q,updatedValue:e=>{X(e)},height:300})]})]})]}),"digital"===I&&digitalProductInput(),(0,t.jsxs)("div",{children:["simple"===I&&(0,t.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[t.jsx("div",{className:"card-header bg-white py-3 fw-bold",children:Y("Product Information")}),t.jsx("div",{className:"card-body",children:(0,t.jsxs)("div",{className:"row",children:[t.jsx("div",{className:"col-12",children:(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{htmlFor:"inp-6",className:"form-label",children:[Y("Item Quantity"),"*(",Y("Set -1 to make it unlimited"),")"]}),t.jsx("input",{type:"number",min:"-1",id:"inp-6",className:j().input+" form-control",name:"qty",defaultValue:l.product.quantity,required:!0,onWheel:e=>e.target.blur()})]})}),t.jsx("div",{className:"col-12",children:(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{className:"form-label",children:[Y("sku"),"*"]}),t.jsx("input",{type:"text",className:j().input+" form-control",name:"sku",defaultValue:l.product.sku,required:!0})]})})]})})]}),"variable"===I&&(0,t.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[t.jsx("div",{className:"card-header bg-white py-3 fw-bold",children:Y("Product Variation")}),(0,t.jsxs)("div",{className:"card-body",children:[(0,t.jsxs)("div",{className:"row py-3",children:[t.jsx("label",{className:"form-label",children:Y("Colors")}),t.jsx(d.MultiSelect,{options:ee,onChange:e=>{y(e)},value:v,labelledBy:"Select Color"})]}),(0,t.jsxs)("div",{className:"py-3",children:[t.jsx("label",{className:"form-label",children:Y("Attributes")}),(0,t.jsxs)("select",{className:j().input+" form-control",defaultValue:ea,onChange:e=>changeAttr(e.target.value),children:[t.jsx("option",{value:"",disabled:!0,children:Y("Select Attribute")}),l.attribute&&l.attribute.map((e,a)=>t.jsx("option",{value:a,children:e.name},a))]})]}),S.length>0&&l.attribute&&(0,t.jsxs)("div",{className:"row py-3",children:[t.jsx("label",{className:"form-label",children:l.attribute[S]&&l.attribute[S].name}),t.jsx(d.MultiSelect,{options:(e=>{let a=[];return l.attribute[e]&&l.attribute[e].values.map(s=>a.push({label:s.name,value:s.name,for:l.attribute[e].name})),a})(S),onChange:e=>{F(e)},value:C,labelledBy:"Select Item"})]}),M.length>0&&M.map((e,a)=>(0,t.jsxs)("div",{children:[t.jsx("hr",{}),(0,t.jsxs)("h6",{children:[Y("Variant"),":"," ",`${e.color?e.color:""} ${e.color&&e.attr?"+":""} ${e.attr?e.attr:""}`]}),(0,t.jsxs)("div",{className:"row",children:[t.jsx("div",{className:"col-12 col-md-3",children:(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{className:"form-label",children:[Y("Additional Price"),"*"]}),t.jsx("input",{type:"number",min:"0",step:"0.01",className:j().input+" form-control",name:"price",required:!0,value:e.price||"",onChange:e=>handleInputChange(e,a),onWheel:e=>e.target.blur()}),t.jsx("div",{className:"small text-primary",children:Y("Set 0 to make it free")})]})}),t.jsx("div",{className:"col-12 col-md-3",children:(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{className:"form-label",children:[Y("sku"),"*"]}),t.jsx("input",{type:"text",className:j().input+" form-control",name:"sku",required:!0,value:e.sku||"",onChange:e=>handleInputChange(e,a)})]})}),t.jsx("div",{className:"col-12 col-md-3",children:(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{className:"form-label",children:[Y("Item Quantity"),"*"]}),t.jsx("input",{type:"number",min:"-1",value:e.qty>-2?e.qty:"",className:j().input+" form-control",name:"qty",required:!0,onChange:e=>handleInputChange(e,a),onWheel:e=>e.target.blur()}),(0,t.jsxs)("div",{className:"small text-primary",children:["S",Y("et -1 to make it unlimited")]})]})}),t.jsx("div",{className:"col-12 col-md-3",children:t.jsx("div",{className:"py-3",children:t.jsx(g.Z,{list:z||[],dataChange:handleInputChange,rootIndex:a,preIndex:e.imageIndex||0})})})]})]},a))]})]})]}),(0,t.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[t.jsx("div",{className:"card-header bg-white py-3 fw-bold",children:Y("SEO Meta Tags")}),(0,t.jsxs)("div",{className:"card-body",children:[(0,t.jsxs)("div",{className:"py-3",children:[t.jsx("label",{htmlFor:"inp-122",className:"form-label",children:Y("Meta Title")}),t.jsx("input",{type:"text",ref:b,id:"inp-122",className:"form-control",defaultValue:l.product.seo.title})]}),(0,t.jsxs)("div",{className:"py-3",children:[t.jsx("label",{htmlFor:"inp-222",className:"form-label",children:Y("Meta Description")}),t.jsx("textarea",{ref:f,id:"inp-222",className:"form-control",defaultValue:l.product.seo.description})]}),t.jsx(u.default,{accept:".jpg,.png,.jpeg",label:Y("Meta Image"),maxFileSizeInBytes:2e6,updateFilesCb:L,preSelectedFiles:l.product.seo.image})]})]})]}),(0,t.jsxs)("div",{className:"col-lg-4",children:[(0,t.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[t.jsx("div",{className:"card-header bg-white py-3 fw-bold",children:Y("Price Information")}),(0,t.jsxs)("div",{className:"card-body",children:[t.jsx("div",{className:"col-12",children:(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{htmlFor:"inp-4",className:"form-label",children:[Y("price"),"*"]}),t.jsx("input",{type:"number",step:"0.01",id:"inp-4",className:"form-control",name:"main_price",required:!0,onWheel:e=>e.target.blur(),defaultValue:l.product.price})]})}),t.jsx("div",{className:"col-12",children:(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{htmlFor:"inp-5",className:"form-label",children:[Y("Discount in Percentage"),"*"]}),t.jsx("input",{type:"number",step:"0.1",min:"0",max:"100",id:"inp-5",placeholder:"0%",className:"form-control",name:"sale_price",required:!0,onWheel:e=>e.target.blur(),defaultValue:"amount"===l.product.discountType?l.product.price-l.product.discount:Math.round((100-100*l.product.discount/l.product.price)*10)/10})]})})]})]}),(0,t.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[t.jsx("div",{className:"card-header bg-white py-3 fw-bold",children:Y("Product Category")}),(0,t.jsxs)("div",{className:"card-body",children:[t.jsx("div",{className:"col-12",children:(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{className:"form-label",children:[Y("categories"),"*"]}),(0,t.jsxs)("select",{className:"form-select",onChange:function(e){V(e.target.value);let a=l.category.find(a=>a.slug===e.target.value);if(a){let e=[],l=[];a.subCategories.forEach(a=>{e.push({name:a.name,slug:a.slug}),a.child?.forEach(e=>{l.push({name:e.name,slug:e.slug})})}),W(e),A(l)}},defaultValue:l.product.categories[0],required:!0,children:[t.jsx("option",{value:"",children:"Select Category"}),l?.category?.map((e,a)=>t.jsx("option",{value:e.slug,children:e.name},a))]},l.product.categories[0])]})}),t.jsx("div",{className:"col-12",children:(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{className:"form-label",children:[Y("Subcategories"),"*"]}),(0,t.jsxs)("select",{className:"form-select",onChange:e=>P(e.target.value),value:q,required:!0,children:[t.jsx("option",{value:"",children:"Select Sub Category"}),T.map((e,a)=>t.jsx("option",{value:e.slug,children:e.name},a))]})]})}),t.jsx("div",{className:"col-12",children:(0,t.jsxs)("div",{className:"py-3",children:[t.jsx("label",{className:"form-label",children:Y("Child Categories")}),(0,t.jsxs)("select",{className:"form-select",onChange:e=>D(e.target.value),value:E,children:[t.jsx("option",{value:"",children:"Select Child Category"}),O.map((e,a)=>t.jsx("option",{value:e.slug,children:e.name},a))]})]})}),(0,t.jsxs)("div",{className:"py-3",children:[t.jsx("label",{className:"form-label",children:Y("Brands")}),(0,t.jsxs)("select",{className:"form-control",onChange:function(e){B(e.target.value)},defaultValue:l.product.brand,children:[t.jsx("option",{value:"",children:"None"}),l.brand&&l.brand.map(e=>t.jsx("option",{value:e.slug,children:e.name},e._id))]},l.product.brand)]})]})]}),(0,t.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[t.jsx("div",{className:"card-header bg-white py-3 fw-bold text-center",children:Y("Vat & Tax Information")}),(0,t.jsxs)("div",{className:"card-body",children:[t.jsx("div",{className:"col-12",children:(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{htmlFor:"inp-4",className:"form-label",children:[Y("Vat in Percentage"),"*"]}),t.jsx("input",{type:"number",step:"0.1",min:"0",max:"100",id:"inp-47",className:"form-control",name:"vat",placeholder:"0%",required:!0,onWheel:e=>e.target.blur(),defaultValue:l.product.vat})]})}),t.jsx("div",{className:"col-12",children:(0,t.jsxs)("div",{className:"py-3",children:[(0,t.jsxs)("label",{htmlFor:"inp-5",className:"form-label",children:[Y("Tax in Percentage"),"*"]}),t.jsx("input",{type:"number",step:"0.1",min:"0",max:"100",id:"inp-57",placeholder:"0%",className:"form-control",name:"tax",required:!0,onWheel:e=>e.target.blur(),defaultValue:l.product.tax})]})})]})]})]})]}),t.jsx("input",{type:"hidden",name:"pid",defaultValue:l.product._id}),t.jsx("div",{className:"py-3",children:t.jsx(h.default,{type:"submit",text:Y("Update Product"),state:G})})]})};s()}catch(e){s(e)}})}};