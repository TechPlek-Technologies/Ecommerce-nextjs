"use strict";(()=>{var e={};e.id=7152,e.ids=[7152],e.modules={21841:e=>{e.exports=require("@aws-sdk/client-s3")},3681:e=>{e.exports=require("custom-id-new")},11185:e=>{e.exports=require("mongoose")},60614:e=>{e.exports=require("next-auth/jwt")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},73292:e=>{e.exports=require("fs/promises")},35414:(e,s,a)=>{a.r(s),a.d(s,{config:()=>g,default:()=>w,routeModule:()=>b});var t={};a.r(t),a.d(t,{default:()=>apiHandler});var r=a(71802),n=a(47153),c=a(56249),o=a(3681),i=a.n(o),u=a(26412),d=a(58364),l=a(79664),p=a(45225),m=a(13808);async function apiHandler(e,s){let{method:a}=e;if(!await (0,d.Z)(e,"brand"))return s.status(403).json({success:!1,message:"Access Forbidden"});switch(await (0,m.Z)(),a){case"GET":try{let e=await p.Z.find({});s.status(200).json({success:!0,brand:e})}catch(e){console.log(e),s.status(400).json({success:!1})}break;case"POST":try{let a=e.body,t=a.categoryImage,r=i()({randomLength:2,lowerCase:!0}),n={brandId:r,name:a.name.trim(),image:t,slug:(0,l.k6)(a.name,!1)};await p.Z.create(n),s.status(200).json({success:!0})}catch(e){console.log(e),s.status(400).json({success:!1})}break;case"PUT":try{let{id:a}=e.body,t=await p.Z.findById(a);t.topBrand=!t.topBrand,await t.save(),s.status(200).json({success:!0})}catch(e){console.log(e),s.status(400).json({success:!1})}break;case"DELETE":try{let a=await p.Z.findById(e.query.id),t=[{Key:a.image[0]?.name}];await (0,u.Z)(t),await a.remove(),s.status(200).json({success:!0})}catch(e){console.log(e),s.status(400).json({success:!1})}break;default:s.status(400).json({success:!1})}}let w=(0,c.l)(t,"default"),g=(0,c.l)(t,"config"),b=new r.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/admin/brand",pathname:"/api/admin/brand",bundlePath:"",filename:""},userland:t})},26412:(e,s,a)=>{a.d(s,{Z:()=>s3DeleteFiles}),a(21841);var t=a(73292);async function s3DeleteFiles(e){try{for(let s=0;s<e.length;s++){let a=e[s],r=`${process.cwd()}/public/uploads/${a.Key}`;await (0,t.unlink)(r)}}catch(e){console.log(e)}}process.env.AWS_BUCKET_NAME}};var s=require("../../../webpack-api-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),a=s.X(0,[4222,9305,3808,8364,9664],()=>__webpack_exec__(35414));module.exports=a})();