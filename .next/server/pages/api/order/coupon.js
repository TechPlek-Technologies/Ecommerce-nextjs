"use strict";(()=>{var e={};e.id=2858,e.ids=[2858],e.modules={11185:e=>{e.exports=require("mongoose")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},98612:(e,t,a)=>{a.r(t),a.d(t,{config:()=>c,default:()=>i,routeModule:()=>l});var s={};a.r(s),a.d(s,{default:()=>apiHandler});var o=a(71802),n=a(47153),r=a(56249),d=a(89821),u=a(13808);function dateFormat(e){let t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1,o=t.getDate();return new Date(`${a}, ${s}, ${o}`)}async function apiHandler(e,t){let{method:a}=e;if(await (0,u.Z)(),"POST"===a)try{let a=await d.Z.findOne({code:e.body.code});if(a){let e=dateFormat(a.active),s=dateFormat(a.expired),o=dateFormat(new Date);e<=o&&o<=s?t.status(200).json({success:!0,message:`Coupon Applied ${a.code}`,discount:a.amount,code:a.code}):t.status(200).json({success:!1,message:"Coupon Code Expired"})}else t.status(200).json({success:!1,message:"Invalid Coupon"})}catch(e){console.log(e),t.status(500).json({success:!1})}else t.status(400).json({success:!1})}let i=(0,r.l)(s,"default"),c=(0,r.l)(s,"config"),l=new o.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/order/coupon",pathname:"/api/order/coupon",bundlePath:"",filename:""},userland:s})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),a=t.X(0,[4222,9305,3808],()=>__webpack_exec__(98612));module.exports=a})();