"use strict";(()=>{var e={};e.id=2857,e.ids=[2857],e.modules={11185:e=>{e.exports=require("mongoose")},60614:e=>{e.exports=require("next-auth/jwt")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},1074:(e,a,s)=>{s.r(a),s.d(a,{config:()=>l,default:()=>p,routeModule:()=>_});var t={};s.r(t),s.d(t,{default:()=>apiHandler});var r=s(71802),d=s(47153),u=s(56249),n=s(58364),o=s(22403),i=s(10090),c=s(13808);async function apiHandler(e,a){let{method:s}=e;if(!await (0,n.Z)(e,"order"))return a.status(403).json({success:!1,message:"Access Forbidden"});switch(await (0,c.Z)(),s){case"GET":try{let s=e.query.id,t=await i.Z.findById(s);t.new&&(t.new=!1,await t.save()),a.status(200).json({success:!0,order:t})}catch(e){console.log(e),a.status(500).json({success:!1})}break;case"PUT":try{let s=e.query.id,t=await i.Z.findByIdAndUpdate(s,{status:e.query.order_status,paymentStatus:e.query.payment_status}),r="";r="payment"===e.query.action?`<p>Order (<a href="/dashboard/orders/${t._id}" target="_blank">${t.orderId}</a>) payment status changed to (${e.query.payment_status})</p>`:`<p>Order (<a href="/dashboard/orders/${t._id}" target="_blank">${t.orderId}</a>) status changed to (${e.query.order_status})</p>`,await o.Z.create({message:r}),a.status(200).json({success:!0})}catch(e){console.log(e),a.status(500).json({success:!1})}break;default:a.status(400).json({success:!1})}}let p=(0,u.l)(t,"default"),l=(0,u.l)(t,"config"),_=new r.PagesAPIRouteModule({definition:{kind:d.x.PAGES_API,page:"/api/order/[id]",pathname:"/api/order/[id]",bundlePath:"",filename:""},userland:t})}};var a=require("../../../webpack-api-runtime.js");a.C(e);var __webpack_exec__=e=>a(a.s=e),s=a.X(0,[4222,9305,3808,8364],()=>__webpack_exec__(1074));module.exports=s})();