"use strict";(()=>{var e={};e.id=6306,e.ids=[6306],e.modules={75184:e=>{e.exports=require("@reduxjs/toolkit")},3681:e=>{e.exports=require("custom-id-new")},11185:e=>{e.exports=require("mongoose")},35648:e=>{e.exports=require("next-redux-wrapper")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},99648:e=>{e.exports=import("axios")},6025:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{config:()=>d,default:()=>u,routeModule:()=>p});var n=r(71802),i=r(47153),o=r(56249),s=r(5147),c=e([s]);s=(c.then?(await c)():c)[0];let u=(0,o.l)(s,"default"),d=(0,o.l)(s,"config"),p=new n.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/checkout/razorpay",pathname:"/api/checkout/razorpay",bundlePath:"",filename:""},userland:s});a()}catch(e){a(e)}})},39904:(e,t,r)=>{r.d(t,{Z:()=>o});var a=r(11185),n=r(39305);let i=new a.Schema(n.Xd),o=a.models.setting||(0,a.model)("setting",i)},5147:(e,t,r)=>{r.a(e,async(e,a)=>{try{r.r(t),r.d(t,{default:()=>apiHandler});var n=r(3681),i=r.n(n),o=r(39904),s=r(39038),c=r(99648),u=e([c]);c=(u.then?(await u)():u)[0];let discountPrice=(e,t)=>e/100*t,generateBasicAuthHeader=(e,t)=>{let r=`${e}:${t}`,a=Buffer.from(r,"utf-8").toString("base64"),n=`Basic ${a}`;return n};async function apiHandler(e,t){let{method:r}=e;if("POST"===r)try{let r=await o.Z.findOne({}),a=r.currency.name,n=r.currency.exchangeRate,{cartData:u}=e.body,d=+u.deliveryInfo?.cost,p=u.items.reduce((e,t)=>e+t.qty*t.price,0),l=u.items.reduce((e,t)=>{var r;let a=t.qty*t.price;return e+(r=t.vat,a*r/100)},0),m=u.items.reduce((e,t)=>{var r;let a=t.qty*t.price;return e+(r=t.tax,a*r/100)},0),y=discountPrice(u.coupon.discount,+p),h=p+l+m+d-y,x=(0,s.m3)(h,n),g=generateBasicAuthHeader("",""),f="INR"===a?h:x,v="T"+i()({randomLength:4,upperCase:!0}),w={amount:(100*f).toString(),currency:"INR"===a?"INR":"USD",receipt:v},_={method:"post",maxBodyLength:1/0,url:"https://api.razorpay.com/v1/orders",headers:{"Content-Type":"application/json",Authorization:g},data:JSON.stringify(w)},q=await c.default.request(_).then(e=>e.data);t.status(200).json({id:q.id,currency:q.currency,amount:q.amount})}catch(e){console.log(e),t.status(400).json(e.message)}else t.status(400).json({success:!1})}a()}catch(e){a(e)}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[4222,9305,9038],()=>__webpack_exec__(6025));module.exports=r})();