"use strict";(()=>{var e={};e.id=2759,e.ids=[2759],e.modules={3681:e=>{e.exports=require("custom-id-new")},11185:e=>{e.exports=require("mongoose")},60614:e=>{e.exports=require("next-auth/jwt")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},73292:e=>{e.exports=require("fs/promises")},2803:(e,s,t)=>{t.r(s),t.d(s,{config:()=>w,default:()=>f,routeModule:()=>g});var a={};t.r(a),t.d(a,{default:()=>apiHandler});var r=t(71802),o=t(47153),n=t(56249),u=t(58364),c=t(28434),i=t(13808),d=t(79664),l=t(3681),p=t.n(l),m=t(11185);async function apiHandler(e,s){let{method:t}=e;if(!await (0,u.Z)(e,"product"))return s.status(403).json({success:!1,message:"Access Forbidden"});switch(await (0,i.Z)(),t){case"GET":try{let e=await c.Z.find({}).sort("-date").exec();s.status(200).json({success:!0,product:e})}catch(e){console.log(e),s.status(400).json({success:!1})}break;case"PUT":try{let t=await c.Z.findById(e.body.id);if(!t)throw Error("Original document not found.");let a=new c.Z(t.toObject());a._id=new m.Types.ObjectId,a.name=`Clone ${a.name}`,a.slug=(0,d.k6)(`${a.name} clone`,!0),a.date=Date.now(),a.productId="P"+p()({randomLength:4,upperCase:!0}),await a.save(),s.status(200).json({success:!0,message:"Product Successfully Cloned"})}catch(e){console.log(e),s.status(400).json({success:!1,message:e.message})}break;default:s.status(400).json({success:!1})}}let f=(0,n.l)(a,"default"),w=(0,n.l)(a,"config"),g=new r.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/product",pathname:"/api/product",bundlePath:"",filename:""},userland:a})}};var s=require("../../webpack-api-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[4222,9305,3808,8364,9664],()=>__webpack_exec__(2803));module.exports=t})();