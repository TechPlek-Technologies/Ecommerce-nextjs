"use strict";(()=>{var e={};e.id=2070,e.ids=[2070],e.modules={3681:e=>{e.exports=require("custom-id-new")},11185:e=>{e.exports=require("mongoose")},60614:e=>{e.exports=require("next-auth/jwt")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},73292:e=>{e.exports=require("fs/promises")},22402:(e,s,r)=>{r.r(s),r.d(s,{config:()=>_,default:()=>S,routeModule:()=>k});var t={};r.r(t),r.d(t,{config:()=>g,default:()=>apiHandler});var a=r(71802),i=r(47153),n=r(56249),u=r(3681),o=r.n(u),p=r(58364),l=r(79664),c=r(37631),d=r(45225),m=r(1112),f=r(88222),w=r(28434),x=r(13808),b=r(11217);let g={api:{bodyParser:!1}};async function apiHandler(e,s){let{method:r}=e;if(!await (0,p.Z)(e,"product"))return s.status(403).json({success:!1,message:"Access Forbidden"});switch(await (0,x.Z)(),r){case"GET":try{let e=await m.Z.find({}),r=await c.Z.find({}),t=await f.Z.find({}),a=await d.Z.find({});s.status(200).json({success:!0,category:e,attribute:r,color:t,brand:a})}catch(e){console.log(e),s.status(500).json({success:!1})}break;case"POST":try{let r=await (0,b.t)(e),{name:t,unit:a,unit_val:i,main_price:n,sale_price:u,description:p,short_description:c,type:d,category:m,subcategory:f,brand:x,qty:g,trending:S,new_product:_,best_selling:k,sku:O,color:P,attribute:j,selectedAttribute:J,variant:N,displayImage:h,galleryImages:q,seo:v,childCategory:Z,vat:F,tax:y}=r.field,A="P"+o()({randomLength:4,upperCase:!0}),E=JSON.parse(m),I=JSON.parse(f),M=JSON.parse(Z),D=JSON.parse(h),C=JSON.parse(q),G=JSON.parse(P),H=JSON.parse(j),T=JSON.parse(N),L=JSON.parse(v),R=(n-u/100*n).toFixed(1),V={name:t.trim(),slug:(0,l.k6)(t,!0),productId:A,unit:a.trim(),unitValue:i.trim(),price:n,discount:R,shortDescription:c.trim(),description:p,type:d,image:D,gallery:C,categories:E,subcategories:I,childCategories:M,brand:x.trim(),trending:!!S,new:!!_,bestSelling:!!k,seo:L,tax:y,vat:F};"simple"===d?(V.quantity=g,V.sku=O):(V.colors=G,V.attributes=H,V.variants=T,V.attributeIndex=J),await w.Z.create(V),s.status(200).json({success:!0})}catch(e){console.log(e),s.status(400).json({success:!1})}break;default:s.status(400).json({success:!1})}}let S=(0,n.l)(t,"default"),_=(0,n.l)(t,"config"),k=new a.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/product/create",pathname:"/api/product/create",bundlePath:"",filename:""},userland:t})},11217:(e,s,r)=>{r.d(s,{c:()=>parseForm,t:()=>parseFormMultiple});let t=require("formidable");var a=r.n(t);function parseForm(e){return new Promise((s,r)=>{let t=a()({keepExtensions:!0,uploadDir:"./public/uploads"});t.parse(e,(e,t,a)=>{if(e)return r(e);s({field:t,file:a})})})}function parseFormMultiple(e){return new Promise((s,r)=>{let t=a()({multiples:!0,keepExtensions:!0,uploadDir:"./public/uploads"});t.parse(e,(e,t,a)=>{if(e)return r(e);s({field:t,file:a})})})}}};var s=require("../../../webpack-api-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),r=s.X(0,[4222,9305,3808,8364,9664],()=>__webpack_exec__(22402));module.exports=r})();