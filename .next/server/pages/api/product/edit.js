"use strict";(()=>{var e={};e.id=6562,e.ids=[6562],e.modules={11185:e=>{e.exports=require("mongoose")},60614:e=>{e.exports=require("next-auth/jwt")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},35173:(e,t,s)=>{s.r(t),s.d(t,{config:()=>x,default:()=>b,routeModule:()=>g});var a={};s.r(a),s.d(a,{config:()=>w,default:()=>apiHandler});var r=s(71802),i=s(47153),n=s(56249),u=s(58364),o=s(37631),l=s(45225),p=s(1112),d=s(88222),c=s(28434),f=s(13808),m=s(11217);let w={api:{bodyParser:!1}};async function apiHandler(e,t){let{method:s}=e;if(!await (0,u.Z)(e,"product"))return t.status(403).json({success:!1,message:"Access Forbidden"});switch(await (0,f.Z)(),s){case"GET":try{let{slug:s}=e.query,a=await c.Z.findOne({slug:s}),r=await p.Z.find({}),i=await o.Z.find({}),n=await d.Z.find({}),u=await l.Z.find({});t.status(200).json({success:!0,product:a,category:r,attribute:i,color:n,brand:u})}catch(e){console.log(e),t.status(400).json({success:!1})}break;case"POST":try{let s=await (0,m.t)(e),{name:a,unit:r,unit_val:i,sale_price:n,description:u,short_description:o,type:l,category:p,subcategory:d,brand:f,qty:w,trending:b,new_product:x,best_selling:g,sku:S,color:O,main_price:_,attribute:j,selectedAttribute:k,variant:J,pid:N,displayImage:P,galleryImages:v,seo:Z,childCategory:h,vat:q,tax:y}=s.field,F=JSON.parse(p),A=JSON.parse(d),E=JSON.parse(h),I=JSON.parse(P),M=JSON.parse(v),D=JSON.parse(O),G=JSON.parse(j),H=JSON.parse(J),T=JSON.parse(Z),B=(_-n/100*_).toFixed(1),C={name:a.trim(),unit:r.trim(),unitValue:i.trim(),price:_,discount:B,shortDescription:o.trim(),description:u,type:l,image:I,gallery:M,categories:F,subcategories:A,childCategories:E,brand:f.trim(),trending:!!b,new:!!x,bestSelling:!!g,seo:T,tax:y,vat:q};"simple"===l?(C.quantity=w,C.sku=S):(C.colors=D,C.attributes=G,C.variants=H,C.attributeIndex=k),await c.Z.findByIdAndUpdate(N,C),t.status(200).json({success:!0})}catch(e){console.log(e),t.status(400).json({success:!1})}break;default:t.status(400).json({success:!1})}}let b=(0,n.l)(a,"default"),x=(0,n.l)(a,"config"),g=new r.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/product/edit",pathname:"/api/product/edit",bundlePath:"",filename:""},userland:a})},11217:(e,t,s)=>{s.d(t,{c:()=>parseForm,t:()=>parseFormMultiple});let a=require("formidable");var r=s.n(a);function parseForm(e){return new Promise((t,s)=>{let a=r()({keepExtensions:!0,uploadDir:"./public/uploads"});a.parse(e,(e,a,r)=>{if(e)return s(e);t({field:a,file:r})})})}function parseFormMultiple(e){return new Promise((t,s)=>{let a=r()({multiples:!0,keepExtensions:!0,uploadDir:"./public/uploads"});a.parse(e,(e,a,r)=>{if(e)return s(e);t({field:a,file:r})})})}}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[4222,9305,3808,8364],()=>__webpack_exec__(35173));module.exports=s})();