"use strict";(()=>{var e={};e.id=2365,e.ids=[2365],e.modules={21841:e=>{e.exports=require("@aws-sdk/client-s3")},11185:e=>{e.exports=require("mongoose")},60614:e=>{e.exports=require("next-auth/jwt")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},73292:e=>{e.exports=require("fs/promises")},96522:(e,s,a)=>{a.r(s),a.d(s,{config:()=>p,default:()=>d,routeModule:()=>m});var t={};a.r(t),a.d(t,{default:()=>apiHandler});var r=a(71802),i=a(47153),o=a(56249),n=a(26412),u=a(58364),l=a(28434),c=a(13808);async function apiHandler(e,s){let{method:a}=e;if(!await (0,u.Z)(e,"product"))return s.status(403).json({success:!1,message:"Access Forbidden"});if(await (0,c.Z)(),"DELETE"===a)try{let{id:a}=e.query,t=await l.Z.findById(a),r=[...t.image,...t.gallery,...t.seo.image],i=[];await r.map(e=>i.push({Key:e.name})),await (0,n.Z)(i),await t.remove(),s.json({success:!0})}catch(e){console.log(e),s.status(400).json({success:!1})}else s.status(400).json({success:!1})}let d=(0,o.l)(t,"default"),p=(0,o.l)(t,"config"),m=new r.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/product/delete/[id]",pathname:"/api/product/delete/[id]",bundlePath:"",filename:""},userland:t})},26412:(e,s,a)=>{a.d(s,{Z:()=>s3DeleteFiles}),a(21841);var t=a(73292);async function s3DeleteFiles(e){try{for(let s=0;s<e.length;s++){let a=e[s],r=`${process.cwd()}/public/uploads/${a.Key}`;await (0,t.unlink)(r)}}catch(e){console.log(e)}}process.env.AWS_BUCKET_NAME}};var s=require("../../../../webpack-api-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),a=s.X(0,[4222,9305,3808,8364],()=>__webpack_exec__(96522));module.exports=a})();