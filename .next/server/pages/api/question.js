"use strict";(()=>{var e={};e.id=1012,e.ids=[1012],e.modules={11185:e=>{e.exports=require("mongoose")},60614:e=>{e.exports=require("next-auth/jwt")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},59167:(e,s,a)=>{a.r(s),a.d(s,{config:()=>p,default:()=>l,routeModule:()=>m});var t={};a.r(t),a.d(t,{default:()=>apiHandler});var u=a(71802),n=a(47153),r=a(56249),i=a(60614),o=a(22403),c=a(28434),d=a(13808);async function apiHandler(e,s){let{method:a}=e,t=process.env.AUTH_SECRET,u=await (0,i.getToken)({req:e,secret:t});if(!u)return s.status(403).json({success:!1,message:"Access Forbidden"});switch(await (0,d.Z)(),a){case"POST":try{let{pid:a,question:t}=e.body,n={userName:u.user.name,email:u.user.email,question:t},r=await c.Z.findByIdAndUpdate(a,{$push:{question:n}}),i=`<p>${u.user.name} asked a question about the product (<a href="/product/${r.slug}" target="_blank">${r.name}</a>)</p>`;await o.Z.create({message:i}),s.status(200).json({success:!0})}catch(e){console.log(e),s.status(500).json({success:!1})}break;case"PUT":try{if(!u.user.a)return s.status(403).json({success:!1,message:"Access Forbidden"});let{id:a,pid:t,answer:n}=e.body;await c.Z.findOneAndUpdate({_id:t,"question._id":a},{$set:{"question.$.answer":n}}),s.status(200).json({success:!0})}catch(e){console.log(e),s.status(200).json({success:!1})}break;default:s.status(400).json({success:!1})}}let l=(0,r.l)(t,"default"),p=(0,r.l)(t,"config"),m=new u.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/question",pathname:"/api/question",bundlePath:"",filename:""},userland:t})}};var s=require("../../webpack-api-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),a=s.X(0,[4222,9305,3808],()=>__webpack_exec__(59167));module.exports=a})();