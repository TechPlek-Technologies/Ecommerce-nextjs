(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3297],{40644:function(e,t,a){"use strict";a.d(t,{w:function(){return s}});var o=a(87462),n=a(67294),r=a(7529),s=n.forwardRef(function(e,t){return n.createElement(r.r,(0,o.Z)({iconAttrs:{fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},iconVerticalAlign:"middle",iconViewBox:"0 0 16 16"},e,{ref:t}),n.createElement("path",{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"}),n.createElement("path",{fillRule:"evenodd",d:"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"}))});s.displayName="PencilSquare"},25137:function(e,t,a){"use strict";a.d(t,{r:function(){return s}});var o=a(87462),n=a(67294),r=a(7529),s=n.forwardRef(function(e,t){return n.createElement(r.r,(0,o.Z)({iconAttrs:{fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},iconVerticalAlign:"middle",iconViewBox:"0 0 16 16"},e,{ref:t}),n.createElement("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}),n.createElement("path",{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"}))});s.displayName="Trash"},21882:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/categories/childcategories",function(){return a(67306)}])},67306:function(e,t,a){"use strict";a.r(t);var o=a(85893),n=a(25137),r=a(40644),s=a(5152),l=a.n(s),c=a(67294),i=a(22120),d=a(25617),u=a(22920),b=a(59734),g=a(71178),h=a.n(g),m=a(2022);let _=l()(()=>a.e(44).then(a.bind(a,90044)),{loadableGenerated:{webpack:()=>[90044]}}),f=l()(()=>a.e(6744).then(a.bind(a,36744)),{loadableGenerated:{webpack:()=>[36744]}}),p=l()(()=>Promise.all([a.e(3253),a.e(8505)]).then(a.bind(a,3347)),{loadableGenerated:{webpack:()=>[3347]}}),y=l()(()=>a.e(8214).then(a.bind(a,18214)),{loadableGenerated:{webpack:()=>[18214]}}),SubcategoryTable=e=>{let{data:t,error:a,mutate:s}=(0,b.ZP)("/api/categories",m.gN),[l,g]=(0,c.useState)([]),[x,w]=(0,c.useState)(!1),[v,j]=(0,c.useState)({}),S=(0,c.useRef)(null),{t:N}=(0,i.$G)();(0,c.useEffect)(()=>{if(t&&t.category){let e=[];t.category.forEach(t=>t.subCategories.forEach(a=>{a.child.forEach(o=>{o.categoryId=t._id,o.category=t.name,o.subcategoryId=a._id,o.subcategory=a.name,e.push(o)})})),g(e)}},[t]);let{session:C}=(0,d.v9)(e=>e.localSession),[E,M]=(0,c.useState)({});(0,c.useEffect)(()=>{M((0,m.wn)(C,"category"))},[C]);let openModal=(e,t,a,o,n)=>{j({categoryid:e,subcategoryId:t,slug:a,name:o,action:n}),w(!0)},closeModal=()=>{w(!1)},deleteProduct=async()=>{w(!1),await (0,m.SR)("/api/categories/childcategories?categoryId=".concat(v.categoryid,"&subcategoryId=").concat(v.subcategoryId,"&slug=").concat(v.slug)).then(e=>e.success?(u.toast.success("Child Category Deleted Successfully"),s()):u.toast.error("Something Went Wrong")).catch(e=>{console.log(e),u.toast.error("Something Went Wrong")})},updateProduct=async()=>{try{let e=JSON.stringify({categoryId:v.categoryid,subcategoryId:v.subcategoryId,name:v.name,slug:v.slug,update:S.current.value}),t=new FormData;t.append("data",e);let a=await (0,m.VA)("/api/categories/childcategories",t);a.success?(u.toast.success("Subcategory Updated Successfully"),s()):u.toast.error("Something Went Wrong"),w(!1)}catch(e){console.log(e),u.toast.error("Something Went Wrong")}},[k,V]=c.useState(""),[I,z]=c.useState(!1),A=l.filter(e=>e.name&&e.name.toLowerCase().includes(k.toLowerCase())),H=c.useMemo(()=>(0,o.jsx)(f,{onFilter:e=>V(e),onClear:()=>{k&&(z(!I),V(""))},filterText:k}),[k,I]),P=[{name:N("name"),selector:e=>e.name,sortable:!0},{name:N("slug"),selector:e=>e.slug,sortable:!0},{name:N("Parent Category"),selector:e=>e.category,sortable:!0},{name:N("Subcategory"),selector:e=>e.subcategory,sortable:!0},{name:N("action"),selector:e=>(0,o.jsxs)("div",{children:[E.delete&&(0,o.jsx)("div",{className:h().button,onClick:()=>openModal(e.categoryId,e.subcategoryId,e.slug,e.name,"delete"),children:(0,o.jsx)(n.r,{width:22,height:22,title:"DELETE"})}),E.edit&&(0,o.jsx)("div",{className:h().button,onClick:()=>openModal(e.categoryId,e.subcategoryId,e.slug,e.name,"edit"),children:(0,o.jsx)(r.w,{width:22,height:22,title:"EDIT"})})]})}];return(0,o.jsxs)(o.Fragment,{children:[a?(0,o.jsx)("div",{className:"text-center text-danger",children:"failed to load"}):t?(0,o.jsx)("div",{className:h().container,children:(0,o.jsx)(_,{columns:P,data:A,pagination:!0,paginationResetDefaultPage:I,subHeader:!0,subHeaderComponent:H,persistTableHead:!0,customStyles:{rows:{style:{minHeight:"92px",fontSize:"15px"}},headCells:{style:{fontSize:"15px"}}}})}):(0,o.jsx)(y,{}),(0,o.jsx)(p,{isOpen:x,handleCloseModal:closeModal,small:!0,children:"delete"===v.action?(0,o.jsxs)("div",{className:h().modal_icon,children:[(0,o.jsx)(n.r,{width:70,height:70}),(0,o.jsx)("p",{children:"Are you sure, you want to delete?"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{className:h().danger_button,onClick:()=>deleteProduct(),children:"Delete"}),(0,o.jsx)("button",{className:h().success_button,onClick:()=>closeModal(),children:"Cancel"})]})]}):(0,o.jsxs)("div",{className:"p-4",children:[(0,o.jsxs)("div",{className:"mb-5",children:[(0,o.jsx)("label",{htmlFor:"inp-1",className:"form-label",children:"Subcategory Name*"}),(0,o.jsx)("input",{type:"text",id:"inp-1",ref:S,className:"form-control",defaultValue:v.name,required:!0})]}),(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("button",{className:h().danger_button,onClick:()=>updateProduct(),children:"Update"}),(0,o.jsx)("button",{className:h().success_button,onClick:()=>closeModal(),children:"Cancel"})]})]})})]})};SubcategoryTable.requireAuthAdmin=!0,SubcategoryTable.dashboard=!0,t.default=SubcategoryTable},71178:function(e){e.exports={container:"table_container__f1mC4",button:"table_button__LF8_5",modal_icon:"table_modal_icon__t_aHR",danger_button:"table_danger_button__jpS_l",success_button:"table_success_button__lcGr5",color_viewer:"table_color_viewer__54oBu",search_bar:"table_search_bar__anNGy",search_bar_button:"table_search_bar_button__OjZ8a"}}},function(e){e.O(0,[7529,9734,9774,2888,179],function(){return e(e.s=21882)}),_N_E=e.O()}]);