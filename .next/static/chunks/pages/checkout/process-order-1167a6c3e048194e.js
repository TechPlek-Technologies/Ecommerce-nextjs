(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6840],{36578:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/checkout/process-order",function(){return r(60990)}])},60990:function(e,t,r){"use strict";r.r(t);var s=r(85893),c=r(11163),n=r(67294),o=r(25617),a=r(22920),u=r(2022),i=r(58210),d=r(9990),l=r.n(d);let CheckoutProcess=()=>{let e=(0,c.useRouter)(),t=(0,o.v9)(e=>e.cart),r=(0,o.I0)(),d=(0,u.Ou)(t)+t.deliveryInfo.cost,[h,_]=(0,n.useState)({}),[p,f]=(0,n.useState)(!1),processOrder=async s=>{try{let{coupon:c,items:n,billingInfo:o,shippingInfo:d,deliveryInfo:l}=t,h={coupon:c,products:n,billingInfo:o,shippingInfo:d,deliveryInfo:l,paymentData:{method:s.method,id:s.id}},_=new FormData;_.append("checkoutData",JSON.stringify(h));let p=await (0,u.qC)("/api/order/new",_);p&&p.success?(r((0,i.s9)()),a.toast.success("Order successfully placed"),e.push("/checkout/success/".concat(p.createdOrder._id))):a.toast.error("Something Went Wrong (500)")}catch(e){a.toast.error("Something Went Wrong ".concat(e)),console.log(e)}};return((0,n.useEffect)(()=>{if(e.query.trn_id){let t=e.query.trn_id,r=e.query.gateway,s=Number(e.query.am);17==t.length&&r.length>0&&s===d?(_({method:r,id:t}),f(!0)):a.toast.error("Invalid Request")}},[d,e]),(0,n.useEffect)(()=>{p&&processOrder(h)},[h,p]),t&&t.items.length>0)?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"layout_top",children:(0,s.jsx)("div",{className:l().container,children:(0,s.jsx)("h2",{className:l().h2,children:"Processing Order..."})})})}):null};CheckoutProcess.footer=!1,t.default=CheckoutProcess},9990:function(e){e.exports={container:"payment_container__8lFBc",h2:"payment_h2__vJpws"}},11163:function(e,t,r){e.exports=r(59974)}},function(e){e.O(0,[9774,2888,179],function(){return e(e.s=36578)}),_N_E=e.O()}]);