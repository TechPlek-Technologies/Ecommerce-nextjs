(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7957],{96454:function(e,a,l){"use strict";l.r(a);var s=l(85893),r=l(12918),t=l.n(r),c=l(67294),i=l(11177),d=l(22920),n=l(59734),o=l(2022),m=l(94504),u=l(49460),p=l(76606),h=l(18214),x=l(83490),b=l.n(x),j=l(58165),N=l(22120);a.default=e=>{var a;let l="/api/product/edit?slug=".concat(e.slug),{data:r,error:x}=(0,n.ZP)(l,o.gN),g=(0,c.useRef)(),f=(0,c.useRef)(""),v=(0,c.useRef)(""),[y,S]=(0,c.useState)([]),[w,C]=(0,c.useState)([]),[k,I]=(0,c.useState)([]),[F,V]=(0,c.useState)([]),[q,_]=(0,c.useState)(""),[P,E]=(0,c.useState)(""),[D,W]=(0,c.useState)(""),[O,J]=(0,c.useState)([]),[T,A]=(0,c.useState)([]),[B,U]=(0,c.useState)(""),[M,z]=(0,c.useState)([]),[H,R]=(0,c.useState)([]),[G,Q]=(0,c.useState)([]),[Z,$]=(0,c.useState)([]),[K,L]=(0,c.useState)(""),[X,Y]=(0,c.useState)(""),{t:ee}=(0,N.$G)();if((0,c.useEffect)(()=>{if(r&&r.product){let e=[];r.product.colors.forEach(a=>e.push({label:a.label,value:a.value}));let a=[];if(r.product.attributes.forEach(e=>a.push({label:e.label,value:e.value,for:e.for})),S(e),C(r.product.attributeIndex?r.product.attributeIndex:""),I(a),V(r.product.type),z(r.product.variants),R(r.product.image),Q(r.product.gallery),$(r.product.seo.image),L(r.product.description),r.product.categories[0]){_(r.product.categories[0]),E(r.product.subcategories[0]),W(r.product.childCategories[0]);let e=r.category.find(e=>e.slug===r.product.categories[0]),a=[],l=[];e.subCategories.forEach(e=>{var s;a.push({name:e.name,slug:e.slug}),null===(s=e.child)||void 0===s||s.forEach(e=>{l.push({name:e.name,slug:e.slug})})}),J(a),A(l)}}},[r]),(0,c.useEffect)(()=>{let e=(y.length||1)*(k.length||1);if(M.length!==e){let e=[];y.length&&k.length?y.map(a=>{k.map(l=>{let s={color:a.label,attr:l.label,price:"",sku:"",qty:"",imageIndex:0};e.push(s)})}):y.length&&!k.length?y.map(a=>{let l={color:a.label,attr:null,price:"",sku:"",qty:"",imageIndex:0};e.push(l)}):!y.length&&k.length&&k.map(a=>{let l={color:null,attr:a.label,price:"",sku:"",qty:"",imageIndex:0};e.push(l)}),z(e)}},[y,k,M.length]),x)return(0,s.jsx)("div",{children:"failed to load"});if(!r)return(0,s.jsx)(h.default,{});if(!r.product)return(0,s.jsx)(t(),{statusCode:404});let ea=[];r.color&&r.color.map(e=>ea.push({label:e.name,value:e.value}));let el=r.product.attributeIndex?r.product.attributeIndex:"",changeAttr=e=>{C(e),I([])},handleInputChange=(e,a)=>{let{name:l,value:s}=e.target,r=[...M];r[a][l]=s,z(r)},getEditorStateData=e=>{let a=e.replace(/(<([^>]+)>)/gi,"").length?e:"";return a},formHandler=async e=>{e.preventDefault(),Y("loading");let a=document.querySelector("#product_form"),l=new FormData(a),s=JSON.stringify(H),r=JSON.stringify(G),t={title:f.current.value.trim(),description:v.current.value.trim(),image:Z};l.append("displayImage",s),l.append("galleryImages",r),l.append("type",F),l.append("category",JSON.stringify([q])),l.append("subcategory",JSON.stringify([P])),l.append("childCategory",JSON.stringify([D])),l.append("brand",B),l.append("color",JSON.stringify(y)),l.append("attribute",JSON.stringify(k)),l.append("selectedAttribute",w),l.append("variant",JSON.stringify(M)),l.append("seo",JSON.stringify(t)),l.append("description",getEditorStateData(K)),await (0,o.qC)("/api/product/edit",l).then(e=>e.success?d.toast.success("Product Updated Successfully"):d.toast.error("Something Went Wrong")).catch(e=>{console.log(e),d.toast.error("Something Went Wrong ".concat(e.message))}),Y("")};return(0,s.jsxs)("form",{id:"product_form",encType:"multipart/form-data",onSubmit:formHandler,children:[(0,s.jsxs)("div",{className:"row",children:[(0,s.jsxs)("div",{className:"col-lg-8",children:[(0,s.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[(0,s.jsx)("div",{className:"card-header bg-white py-3 fw-bold",children:ee("Product Type")}),(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{className:"col-md-4",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsx)("label",{htmlFor:"inp-110",className:"form-label",children:ee("new_product")}),(0,s.jsxs)("div",{className:"form-check form-switch",children:[(0,s.jsx)("input",{className:"form-check-input",type:"checkbox",id:"inp-110",name:"new_product",defaultChecked:r.product.new}),(0,s.jsx)("label",{className:"form-check-label",htmlFor:"inp-110",children:ee("status")})]})]})}),(0,s.jsx)("div",{className:"col-md-4",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsx)("label",{htmlFor:"inp-11",className:"form-label",children:ee("trending_product")}),(0,s.jsxs)("div",{className:"form-check form-switch",children:[(0,s.jsx)("input",{className:"form-check-input",type:"checkbox",id:"inp-11",name:"trending",defaultChecked:r.product.trending}),(0,s.jsx)("label",{className:"form-check-label",htmlFor:"inp-11",children:ee("status")})]})]})}),(0,s.jsx)("div",{className:"col-md-4",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsx)("label",{htmlFor:"inp-111",className:"form-label",children:ee("best_selling_product")}),(0,s.jsxs)("div",{className:"form-check form-switch",children:[(0,s.jsx)("input",{className:"form-check-input",type:"checkbox",id:"inp-111",name:"best_selling",defaultChecked:r.product.bestSelling}),(0,s.jsx)("label",{className:"form-check-label",htmlFor:"inp-111",children:ee("status")})]})]})})]}),(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{htmlFor:"inp-type",className:"form-label",children:[ee("Product Type"),"*"]}),(0,s.jsxs)("select",{id:"inp-type",ref:g,className:b().input+" form-control",required:!0,onChange:()=>V(g.current.value),defaultValue:r.product.type,children:[(0,s.jsx)("option",{value:"",disabled:!0,children:ee("Select Product Type")}),(0,s.jsx)("option",{value:"simple",children:"Simple Product"}),(0,s.jsx)("option",{value:"variable",children:"Variable Product"})]})]})})]})]}),(0,s.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[(0,s.jsx)("div",{className:"card-header bg-white py-3 fw-bold",children:ee("Product Image")}),(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)(m.default,{accept:".jpg,.png,.jpeg",label:ee("Display Image"),maxFileSizeInBytes:2e6,updateFilesCb:e=>R(e),preSelectedFiles:r.product.image}),(0,s.jsx)(m.default,{accept:".jpg,.png,.jpeg",label:ee("Gallery Images"),multiple:!0,maxFileSizeInBytes:2e6,updateFilesCb:e=>Q(e),preSelectedFiles:r.product.gallery})]})]}),(0,s.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[(0,s.jsx)("div",{className:"card-header bg-white py-3 fw-bold text-center",children:ee("Product Description")}),(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{htmlFor:"inp-1",className:"form-label",children:[ee("name"),"*"]}),(0,s.jsx)("input",{type:"text",id:"inp-1",className:b().input+" form-control",name:"name",defaultValue:r.product.name,required:!0})]}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{className:"col-12 col-sm-6",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{htmlFor:"inp-2",className:"form-label",children:[ee("Unit"),"*"]}),(0,s.jsx)("input",{type:"text",id:"inp-2",className:b().input+" form-control",name:"unit",defaultValue:r.product.unit,required:!0})]})}),(0,s.jsx)("div",{className:"col-12 col-sm-6",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{htmlFor:"inp-3",className:"form-label",children:[ee("Unit Value"),"*"]}),(0,s.jsx)("input",{type:"text",id:"inp-3",className:b().input+" form-control",name:"unit_val",defaultValue:r.product.unitValue,required:!0})]})})]})]})]}),(0,s.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[(0,s.jsx)("div",{className:"card-header bg-white py-3 fw-bold",children:ee("Product Description")}),(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{htmlFor:"inp-7",className:"form-label",children:[ee("Short Description"),"*"]}),(0,s.jsx)("textarea",{id:"inp-7",className:b().input+" form-control",name:"short_description",defaultValue:r.product.shortDescription})]}),(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsx)("label",{className:"form-label",children:ee("description")}),(0,s.jsx)(u.default,{previousValue:K,updatedValue:e=>{L(e)},height:300})]})]})]}),"digital"===F&&digitalProductInput(),(0,s.jsxs)("div",{children:["simple"===F&&(0,s.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[(0,s.jsx)("div",{className:"card-header bg-white py-3 fw-bold",children:ee("Product Information")}),(0,s.jsx)("div",{className:"card-body",children:(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{htmlFor:"inp-6",className:"form-label",children:[ee("Item Quantity"),"*(",ee("Set -1 to make it unlimited"),")"]}),(0,s.jsx)("input",{type:"number",min:"-1",id:"inp-6",className:b().input+" form-control",name:"qty",defaultValue:r.product.quantity,required:!0,onWheel:e=>e.target.blur()})]})}),(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{className:"form-label",children:[ee("sku"),"*"]}),(0,s.jsx)("input",{type:"text",className:b().input+" form-control",name:"sku",defaultValue:r.product.sku,required:!0})]})})]})})]}),"variable"===F&&(0,s.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[(0,s.jsx)("div",{className:"card-header bg-white py-3 fw-bold",children:ee("Product Variation")}),(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsxs)("div",{className:"row py-3",children:[(0,s.jsx)("label",{className:"form-label",children:ee("Colors")}),(0,s.jsx)(i.NU,{options:ea,onChange:e=>{S(e)},value:y,labelledBy:"Select Color"})]}),(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsx)("label",{className:"form-label",children:ee("Attributes")}),(0,s.jsxs)("select",{className:b().input+" form-control",defaultValue:el,onChange:e=>changeAttr(e.target.value),children:[(0,s.jsx)("option",{value:"",disabled:!0,children:ee("Select Attribute")}),r.attribute&&r.attribute.map((e,a)=>(0,s.jsx)("option",{value:a,children:e.name},a))]})]}),w.length>0&&r.attribute&&(0,s.jsxs)("div",{className:"row py-3",children:[(0,s.jsx)("label",{className:"form-label",children:r.attribute[w]&&r.attribute[w].name}),(0,s.jsx)(i.NU,{options:(e=>{let a=[];return r.attribute[e]&&r.attribute[e].values.map(l=>a.push({label:l.name,value:l.name,for:r.attribute[e].name})),a})(w),onChange:e=>{I(e)},value:k,labelledBy:"Select Item"})]}),M.length>0&&M.map((e,a)=>(0,s.jsxs)("div",{children:[(0,s.jsx)("hr",{}),(0,s.jsxs)("h6",{children:[ee("Variant"),":"," ","".concat(e.color?e.color:""," ").concat(e.color&&e.attr?"+":""," ").concat(e.attr?e.attr:"")]}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{className:"col-12 col-md-3",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{className:"form-label",children:[ee("Additional Price"),"*"]}),(0,s.jsx)("input",{type:"number",min:"0",step:"0.01",className:b().input+" form-control",name:"price",required:!0,value:e.price||"",onChange:e=>handleInputChange(e,a),onWheel:e=>e.target.blur()}),(0,s.jsx)("div",{className:"small text-primary",children:ee("Set 0 to make it free")})]})}),(0,s.jsx)("div",{className:"col-12 col-md-3",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{className:"form-label",children:[ee("sku"),"*"]}),(0,s.jsx)("input",{type:"text",className:b().input+" form-control",name:"sku",required:!0,value:e.sku||"",onChange:e=>handleInputChange(e,a)})]})}),(0,s.jsx)("div",{className:"col-12 col-md-3",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{className:"form-label",children:[ee("Item Quantity"),"*"]}),(0,s.jsx)("input",{type:"number",min:"-1",value:e.qty>-2?e.qty:"",className:b().input+" form-control",name:"qty",required:!0,onChange:e=>handleInputChange(e,a),onWheel:e=>e.target.blur()}),(0,s.jsxs)("div",{className:"small text-primary",children:["S",ee("et -1 to make it unlimited")]})]})}),(0,s.jsx)("div",{className:"col-12 col-md-3",children:(0,s.jsx)("div",{className:"py-3",children:(0,s.jsx)(j.Z,{list:G||[],dataChange:handleInputChange,rootIndex:a,preIndex:e.imageIndex||0})})})]})]},a))]})]})]}),(0,s.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[(0,s.jsx)("div",{className:"card-header bg-white py-3 fw-bold",children:ee("SEO Meta Tags")}),(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsx)("label",{htmlFor:"inp-122",className:"form-label",children:ee("Meta Title")}),(0,s.jsx)("input",{type:"text",ref:f,id:"inp-122",className:"form-control",defaultValue:r.product.seo.title})]}),(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsx)("label",{htmlFor:"inp-222",className:"form-label",children:ee("Meta Description")}),(0,s.jsx)("textarea",{ref:v,id:"inp-222",className:"form-control",defaultValue:r.product.seo.description})]}),(0,s.jsx)(m.default,{accept:".jpg,.png,.jpeg",label:ee("Meta Image"),maxFileSizeInBytes:2e6,updateFilesCb:$,preSelectedFiles:r.product.seo.image})]})]})]}),(0,s.jsxs)("div",{className:"col-lg-4",children:[(0,s.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[(0,s.jsx)("div",{className:"card-header bg-white py-3 fw-bold",children:ee("Price Information")}),(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{htmlFor:"inp-4",className:"form-label",children:[ee("price"),"*"]}),(0,s.jsx)("input",{type:"number",step:"0.01",id:"inp-4",className:"form-control",name:"main_price",required:!0,onWheel:e=>e.target.blur(),defaultValue:r.product.price})]})}),(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{htmlFor:"inp-5",className:"form-label",children:[ee("Discount in Percentage"),"*"]}),(0,s.jsx)("input",{type:"number",step:"0.1",min:"0",max:"100",id:"inp-5",placeholder:"0%",className:"form-control",name:"sale_price",required:!0,onWheel:e=>e.target.blur(),defaultValue:"amount"===r.product.discountType?r.product.price-r.product.discount:Math.round((100-100*r.product.discount/r.product.price)*10)/10})]})})]})]}),(0,s.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[(0,s.jsx)("div",{className:"card-header bg-white py-3 fw-bold",children:ee("Product Category")}),(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{className:"form-label",children:[ee("categories"),"*"]}),(0,s.jsxs)("select",{className:"form-select",onChange:function(e){_(e.target.value);let a=r.category.find(a=>a.slug===e.target.value);if(a){let e=[],l=[];a.subCategories.forEach(a=>{var s;e.push({name:a.name,slug:a.slug}),null===(s=a.child)||void 0===s||s.forEach(e=>{l.push({name:e.name,slug:e.slug})})}),J(e),A(l)}},defaultValue:r.product.categories[0],required:!0,children:[(0,s.jsx)("option",{value:"",children:"Select Category"}),null==r?void 0:null===(a=r.category)||void 0===a?void 0:a.map((e,a)=>(0,s.jsx)("option",{value:e.slug,children:e.name},a))]},r.product.categories[0])]})}),(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{className:"form-label",children:[ee("Subcategories"),"*"]}),(0,s.jsxs)("select",{className:"form-select",onChange:e=>E(e.target.value),value:P,required:!0,children:[(0,s.jsx)("option",{value:"",children:"Select Sub Category"}),O.map((e,a)=>(0,s.jsx)("option",{value:e.slug,children:e.name},a))]})]})}),(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsx)("label",{className:"form-label",children:ee("Child Categories")}),(0,s.jsxs)("select",{className:"form-select",onChange:e=>W(e.target.value),value:D,children:[(0,s.jsx)("option",{value:"",children:"Select Child Category"}),T.map((e,a)=>(0,s.jsx)("option",{value:e.slug,children:e.name},a))]})]})}),(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsx)("label",{className:"form-label",children:ee("Brands")}),(0,s.jsxs)("select",{className:"form-control",onChange:function(e){U(e.target.value)},defaultValue:r.product.brand,children:[(0,s.jsx)("option",{value:"",children:"None"}),r.brand&&r.brand.map(e=>(0,s.jsx)("option",{value:e.slug,children:e.name},e._id))]},r.product.brand)]})]})]}),(0,s.jsxs)("div",{className:"card mb-5 border-0 shadow",children:[(0,s.jsx)("div",{className:"card-header bg-white py-3 fw-bold text-center",children:ee("Vat & Tax Information")}),(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{htmlFor:"inp-4",className:"form-label",children:[ee("Vat in Percentage"),"*"]}),(0,s.jsx)("input",{type:"number",step:"0.1",min:"0",max:"100",id:"inp-47",className:"form-control",name:"vat",placeholder:"0%",required:!0,onWheel:e=>e.target.blur(),defaultValue:r.product.vat})]})}),(0,s.jsx)("div",{className:"col-12",children:(0,s.jsxs)("div",{className:"py-3",children:[(0,s.jsxs)("label",{htmlFor:"inp-5",className:"form-label",children:[ee("Tax in Percentage"),"*"]}),(0,s.jsx)("input",{type:"number",step:"0.1",min:"0",max:"100",id:"inp-57",placeholder:"0%",className:"form-control",name:"tax",required:!0,onWheel:e=>e.target.blur(),defaultValue:r.product.tax})]})})]})]})]})]}),(0,s.jsx)("input",{type:"hidden",name:"pid",defaultValue:r.product._id}),(0,s.jsx)("div",{className:"py-3",children:(0,s.jsx)(p.default,{type:"submit",text:ee("Update Product"),state:X})})]})}},83490:function(e){e.exports={button_danger:"productForm_button_danger__HuxDf"}},12918:function(e,a,l){e.exports=l(66908)}}]);